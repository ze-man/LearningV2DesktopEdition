<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Learning OS V2.0.5</title>
    <link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@900&amp;family=Segoe+UI:wght@400;700;800&amp;display=swap" rel="stylesheet" />
    <style>
        :root {
            --neon: #00f2ff;
            --neon-glow: rgba(0, 242, 255, 0.3);
            --neon-border: #00f2ff;
            --taskbar-height: 60px;
            --window-header-height: 40px;
        }

        * {
            box-sizing: border-box;
            user-select: none;
        }

        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background: #000;
            overflow: hidden;
            font-family: "Segoe UI", sans-serif;
            cursor: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmZjAwZmYiLz48c3RvcCBvZmZzZXQ9IjUwJSIgc3RvcC1jb2xvcj0iIzAwZmZmZiIvPjxzdG9wIG9mZnNldD0iMTAwJSIgc3RvcC1jb2xvcj0iIzAwZmYwMCIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjxwYXRoIGQ9Ik03IDJMMjQgMTdMMTcgMTdMMjUgMjlMMjEgMzJMMTMgMjBMNyAyNlYyWiIgZmlsbD0idXJsKCNnKSIgc3Ryb2tlPSJ3aGl0ZSIgc3Ryb2tlLXdpZHRoPSIxLjUiLz48L3N2Zz4=")
                0 0, auto !important;
        }

        button, a, input, .desktop-icon, .taskbar-icon, .start-menu-item, .window-control {
            cursor: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImciPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmZjAwZmYiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMwMGZmZmYiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cGF0aCBkPSJNMTQgNEMxMiA0IDExIDUgMTEgN1YxNUw5IDE0TDcgMTVMOCAxN0wxMiAyMkgxOEMyMCAyMiAyMiAyMCAyMiAxOFY4QzIyIDYgMjAgNSAxOCA1SDE3VjlIMTVWNEgxNFoiIGZpbGw9InVybCgjZykiIHN0cm9rZT0id2hpdGUiIHN0cm9rZS13aWR0aD0iMS41Ii8+PC9zdmc+") 0 0, pointer !important;
        }

        /* DESKTOP BACKGROUND */
        #desktop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: calc(100% - var(--taskbar-height));
            background: url("https://idsb.tmgrup.com.tr/ly/uploads/images/2023/02/21/258632.jpg") no-repeat center center fixed;
            background-size: cover;
            overflow: hidden;
            z-index: 1;
        }

        /* DESKTOP ICONS */
        #desktop-icons {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 25px;
            z-index: 100;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 80px;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.2s;
            text-align: center;
        }

        .desktop-icon:hover {
            background: rgba(0, 242, 255, 0.1);
        }

        .desktop-icon.active {
            background: rgba(0, 242, 255, 0.2);
        }

        .desktop-icon-img {
            width: 48px;
            height: 48px;
            margin-bottom: 8px;
            filter: drop-shadow(0 0 5px var(--neon-glow));
        }

        .desktop-icon-text {
            color: white;
            font-size: 12px;
            font-weight: 600;
            text-shadow: 1px 1px 3px black;
            line-height: 1.2;
        }

        /* TASKBAR */
        #taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: var(--taskbar-height);
            background: rgba(10, 10, 20, 0.95);
            border-top: 2px solid var(--neon-border);
            display: flex;
            align-items: center;
            padding: 0 15px;
            z-index: 1000;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.5);
        }

        /* START MENU BUTTON */
        #start-button {
            background: linear-gradient(45deg, var(--neon), #7000ff);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 8px;
            font-size: 24px;
            font-weight: bold;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        #start-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--neon);
        }

        /* TASKBAR ICONS */
        #taskbar-icons {
            display: flex;
            gap: 10px;
            flex: 1;
        }

        .taskbar-icon {
            background: rgba(20, 20, 35, 0.8);
            border: 1px solid rgba(0, 242, 255, 0.3);
            border-radius: 8px;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: var(--neon);
            transition: all 0.2s;
        }

        .taskbar-icon:hover, .taskbar-icon.active {
            background: var(--neon);
            color: #000;
            transform: translateY(-3px);
        }

        /* SYSTEM TRAY */
        #system-tray {
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--neon);
            font-size: 14px;
            font-weight: 600;
            padding: 0 15px;
        }

        #battery-indicator, #clock {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* START MENU */
        #start-menu {
            position: fixed;
            bottom: var(--taskbar-height);
            left: 15px;
            width: 320px;
            height: 450px;
            background: rgba(15, 15, 25, 0.98);
            border: 2px solid var(--neon-border);
            border-radius: 12px 12px 0 0;
            box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.7);
            display: none;
            flex-direction: column;
            z-index: 999;
            overflow: hidden;
        }

        #start-menu.active {
            display: flex;
        }

        #start-header {
            background: rgba(0, 242, 255, 0.1);
            padding: 15px;
            border-bottom: 1px solid var(--neon-border);
            color: var(--neon);
            font-weight: 900;
            font-size: 18px;
            letter-spacing: 1px;
        }

        #start-menu-items {
            flex: 1;
            padding: 15px;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            overflow-y: auto;
        }

        .start-menu-item {
            background: rgba(30, 30, 45, 0.8);
            border: 1px solid rgba(0, 242, 255, 0.2);
            border-radius: 8px;
            padding: 12px;
            color: white;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .start-menu-item:hover {
            background: var(--neon);
            color: #000;
            transform: scale(1.05);
        }

        .start-menu-icon {
            font-size: 24px;
        }

        /* WINDOWS */
        .window {
            position: absolute;
            background: rgba(20, 20, 30, 0.95);
            border: 2px solid var(--neon-border);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            display: none;
            flex-direction: column;
            overflow: hidden;
            z-index: 100;
            min-width: 400px;
            min-height: 300px;
        }

        .window.active {
            display: flex;
            z-index: 101;
        }

        .window-header {
            background: rgba(10, 10, 20, 0.95);
            padding: 0 15px;
            height: var(--window-header-height);
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid var(--neon-border);
            cursor: move;
        }

        .window-title {
            color: var(--neon);
            font-weight: 700;
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        .window-controls {
            display: flex;
            gap: 8px;
        }

        .window-control {
            width: 28px;
            height: 28px;
            border-radius: 6px;
            border: 1px solid rgba(0, 242, 255, 0.3);
            background: rgba(30, 30, 45, 0.8);
            color: var(--neon);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s;
        }

        .window-control:hover {
            background: var(--neon);
            color: #000;
        }

        .window-content {
            flex: 1;
            overflow: auto;
            padding: 0;
        }

        /* GAMES/APPS WINDOW CONTENT */
        .dashboard-zone {
            background: radial-gradient(circle at center, #1a1a2e 0%, #0f0f0f 100%) fixed;
            overflow-y: auto;
            height: 100%;
        }

        .controls-header {
            padding: 15px;
            background: rgba(20, 20, 25, 0.98);
            display: flex;
            justify-content: center;
            gap: 15px;
            border-bottom: 1px solid var(--neon-glow);
        }

        .search-bar {
            width: 60%;
            max-width: 400px;
            padding: 10px 20px;
            border-radius: 30px;
            border: 1px solid rgba(0, 242, 255, 0.5);
            background: #1a1a2e;
            color: white;
            font-size: 14px;
            outline: none;
        }

        .random-btn {
            padding: 10px 20px;
            border-radius: 30px;
            border: none;
            background: linear-gradient(45deg, var(--neon), #7000ff);
            color: white;
            font-weight: bold;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 20px;
            padding: 20px;
            justify-items: center;
            padding-bottom: 60px;
        }

        .game-item, .app-item {
            text-align: center;
            width: 130px;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .game-item:hover, .app-item:hover {
            transform: scale(1.1);
        }

        .icon-emoji {
            width: 100px;
            height: 100px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 60px;
            filter: drop-shadow(0 0 10px var(--neon-glow));
        }

        .icon-img {
            width: 110px;
            height: 110px;
            object-fit: contain;
            border-radius: 15px;
            margin-bottom: 10px;
            border: 2px solid var(--neon-glow);
            background: rgba(255, 255, 255, 0.05);
            box-shadow: 0 0 10px var(--neon-glow);
        }

        .item-name {
            font-size: 10px;
            font-weight: 800;
            color: rgba(255, 255, 255, 0.9);
            text-transform: uppercase;
            display: block;
            min-height: 30px;
            letter-spacing: 0.5px;
            line-height: 1.2;
        }

        /* CHAT WINDOW */
        #chat-bg-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(circle at center, #1a1a2e 0%, #000000 100%);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        #chat-ui-container {
            position: relative;
            z-index: 5;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        #chat-header {
            padding: 10px;
            background: rgba(20, 20, 25, 0.9);
            border-bottom: 1px solid var(--neon-border);
            text-align: center;
        }

        #chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 15px;
            overflow-y: auto;
            padding-bottom: 15px;
        }

        .message-item {
            display: flex;
            align-items: flex-end;
            gap: 8px;
            margin-bottom: 8px;
            animation: fadeIn 0.2s ease;
        }

        .pfp-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 1px solid var(--neon-border);
            object-fit: cover;
        }

        .bubble {
            background: rgba(26, 26, 46, 0.95);
            border: 1px solid var(--neon-glow);
            border-radius: 15px 15px 15px 4px;
            padding: 10px 15px;
            font-size: 13px;
            max-width: 70%;
            color: #fff;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            word-wrap: break-word;
        }

        #footer-controls {
            padding: 10px;
            background: rgba(20, 20, 25, 0.95);
            display: flex;
            justify-content: center;
            gap: 8px;
            border-top: 1px solid var(--neon-border);
        }

        .action-btn {
            padding: 8px 15px;
            border-radius: 20px;
            border: none;
            background: linear-gradient(45deg, var(--neon), #7000ff);
            color: white;
            font-weight: bold;
            font-size: 10px;
            text-transform: uppercase;
        }

        /* OVERLAY FOR GAMES/APPS */
        #overlay-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
            z-index: 2000;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        #close-overlay-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            font-size: 16px;
            border: none;
            border-radius: 50%;
            background: rgba(255, 75, 43, 0.9);
            color: white;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2001;
            opacity: 0.7;
            transition: 0.3s;
        }

        #close-overlay-btn:hover {
            opacity: 1;
            transform: rotate(90deg);
        }

        /* SETTINGS OVERLAY */
        #settings-overlay, #login-overlay {
            position: absolute;
            inset: 0;
            background: #0f0f1e;
            z-index: 999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .auth-container {
            background: #1a1a2e;
            padding: 30px;
            border-radius: 20px;
            border: 1px solid var(--neon-border);
            box-shadow: 0 0 30px var(--neon-glow);
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 280px;
        }

        /* STARFIELD ANIMATION */
        .star-field {
            position: absolute;
            inset: 0;
            pointer-events: none;
            z-index: 2;
        }

        .star {
            position: absolute;
            clip-path: polygon(50% 0%, 60% 40%, 100% 50%, 60% 60%, 50% 100%, 40% 60%, 0% 50%, 40% 40%);
            animation: timedGlare 4s infinite, rainbowShift 10s infinite linear;
            z-index: 2;
        }

        @keyframes timedGlare {
            0%, 15%, 85%, 100% { transform: scale(0.7); filter: brightness(1); }
            50% { transform: scale(1.4); filter: brightness(3); }
        }

        @keyframes rainbowShift {
            0% { background: #ff0055; }
            25% { background: #ffdd00; }
            50% { background: #00ff88; }
            75% { background: #00aaff; }
            100% { background: #ff0055; }
        }

        .shooting-star {
            position: absolute;
            width: 3px;
            height: 3px;
            background: #fff;
            border-radius: 50%;
            opacity: 0;
            box-shadow: 0 0 15px 2px white;
            z-index: 3;
        }

        .shooting-star::before {
            content: "";
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 120px;
            height: 1px;
            background: linear-gradient(90deg, #fff, transparent);
        }

        .animate-shooting {
            animation: shoot 2.5s ease-out;
        }

        @keyframes shoot {
            0% { transform: rotate(-35deg) translateX(0); opacity: 1; }
            100% { transform: rotate(-35deg) translateX(-1200px); opacity: 0; }
        }

        /* DESKTOP WELCOME TEXT */
        .expressive-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 5;
            font-family: "Unbounded", sans-serif;
            font-size: clamp(2rem, 9vw, 5rem);
            font-weight: 900;
            text-align: center;
            letter-spacing: -3px;
            background: linear-gradient(90deg, #ff0055, #ffdd00, #00ff88, #00aaff, #ff0055);
            background-size: 300% auto;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shimmer 5s linear infinite;
            pointer-events: none;
        }

        @keyframes shimmer {
            to { background-position: 300% center; }
        }

        /* WINDOW Z-INDEX MANAGEMENT */
        .window {
            transition: z-index 0.1s;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .window {
                min-width: 95vw;
                min-height: 70vh;
                left: 2.5vw !important;
                top: 10vh !important;
            }
            
            .grid-container {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
                gap: 15px;
            }
            
            #start-menu {
                width: 90vw;
                left: 5vw;
            }
        }
    </style>
</head>
<body>
    <!-- DESKTOP BACKGROUND -->
    <div id="desktop">
        <div class="star-field" id="starField">
            <div id="shooter" class="shooting-star"></div>
        </div>
        
        <div class="expressive-text">
            WELCOME TO FREEDOM OS
        </div>
        
        <!-- DESKTOP ICONS -->
        <div id="desktop-icons">
            <div class="desktop-icon" onclick="openWindow('games-window')" data-window="games-window">
                <div class="desktop-icon-img">üéÆ</div>
                <div class="desktop-icon-text">Games</div>
            </div>
            <div class="desktop-icon" onclick="openWindow('apps-window')" data-window="apps-window">
                <div class="desktop-icon-img">üì±</div>
                <div class="desktop-icon-text">Apps</div>
            </div>
            <div class="desktop-icon" onclick="openWindow('chat-window')" data-window="chat-window">
                <div class="desktop-icon-img">üí¨</div>
                <div class="desktop-icon-text">Chat</div>
            </div>
            <div class="desktop-icon" onclick="openWindow('updates-window')" data-window="updates-window">
                <div class="desktop-icon-img">üì∞</div>
                <div class="desktop-icon-text">Updates</div>
            </div>
            <div class="desktop-icon" onclick="openWindow('settings-window')" data-window="settings-window">
                <div class="desktop-icon-img">‚öôÔ∏è</div>
                <div class="desktop-icon-text">Settings</div>
            </div>
        </div>
        
        <!-- WINDOWS -->
        <!-- Games Window -->
        <div id="games-window" class="window" style="width: 800px; height: 600px; top: 10%; left: 15%;">
            <div class="window-header">
                <div class="window-title">üéÆ Games Library</div>
                <div class="window-controls">
                    <button class="window-control" onclick="minimizeWindow('games-window')">‚îÄ</button>
                    <button class="window-control" onclick="maximizeWindow('games-window')">‚ñ°</button>
                    <button class="window-control" onclick="closeWindow('games-window')">‚úï</button>
                </div>
            </div>
            <div class="window-content dashboard-zone">
                <div class="controls-header">
                    <input type="text" class="search-bar" id="game-search" placeholder="SEARCH GAMES..." onkeyup="filterGrid('games')" />
                    <button class="random-btn" onclick="openRandom('games')">üîÄ RANDOM</button>
                </div>
                <div class="grid-container" id="games-grid">
                    <!-- Games will be inserted here by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Apps Window -->
        <div id="apps-window" class="window" style="width: 700px; height: 500px; top: 15%; left: 20%;">
            <div class="window-header">
                <div class="window-title">üì± Applications</div>
                <div class="window-controls">
                    <button class="window-control" onclick="minimizeWindow('apps-window')">‚îÄ</button>
                    <button class="window-control" onclick="maximizeWindow('apps-window')">‚ñ°</button>
                    <button class="window-control" onclick="closeWindow('apps-window')">‚úï</button>
                </div>
            </div>
            <div class="window-content dashboard-zone">
                <div class="controls-header">
                    <input type="text" class="search-bar" id="app-search" placeholder="SEARCH APPS..." onkeyup="filterGrid('apps')" />
                    <button class="random-btn" onclick="openRandom('apps')">üîÄ RANDOM</button>
                </div>
                <div class="grid-container" id="apps-grid">
                    <!-- Apps will be inserted here by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Chat Window -->
        <div id="chat-window" class="window" style="width: 500px; height: 600px; top: 10%; left: 60%;">
            <div class="window-header">
                <div class="window-title">üí¨ Local Chat</div>
                <div class="window-controls">
                    <button class="window-control" onclick="minimizeWindow('chat-window')">‚îÄ</button>
                    <button class="window-control" onclick="maximizeWindow('chat-window')">‚ñ°</button>
                    <button class="window-control" onclick="closeWindow('chat-window')">‚úï</button>
                </div>
            </div>
            <div class="window-content">
                <div id="chat-bg-layer"></div>
                <div id="login-overlay">
                    <div class="auth-container">
                        <div style="color:var(--neon); font-weight:900; letter-spacing: 2px; text-align:center;">Welcome</div>
                        <div class="auth-tabs">
                            <button class="auth-tab active" id="tab-login" onclick="setAuthMode('login')">LOGIN</button>
                            <button class="auth-tab" id="tab-signup" onclick="setAuthMode('signup')">SIGN UP</button>
                        </div>
                        <input type="text" id="user-input" class="auth-input" placeholder="USERNAME" autocomplete="off" />
                        <input type="password" id="pass-input" class="auth-input" placeholder="PASSWORD" />
                        <div id="name-error"></div>
                        <button class="action-btn" style="width:100%;" onclick="handleAuthSubmit()">ENTER</button>
                    </div>
                </div>
                <div id="settings-overlay" style="display:none;">
                    <h2 style="color:var(--neon)">SETTINGS</h2>
                    <button class="action-btn" onclick="changeName()">Change Name</button>
                    <button class="action-btn" onclick="document.getElementById('pfp-up').click()">Change PFP</button>
                    <button class="action-btn" onclick="document.getElementById('bg-up').click()">Change Background</button>
                    <button class="action-btn" style="background:#ff3333;" onclick="wipeCloudData()">Wipe Profile</button>
                    <button class="action-btn" onclick="toggleSettings()" style="background:#333;">Close</button>
                </div>
                <div id="chat-ui-container">
                    <div id="chat-header">
                        <div style="color:var(--neon); font-weight:900; letter-spacing: 2px;">LOCAL CHAT</div>
                    </div>
                    <div id="chat-area"></div>
                    <div id="footer-controls">
                        <button class="action-btn" onclick="toggleSettings()">‚öôÔ∏è</button>
                        <button class="action-btn" onclick="document.getElementById('img-send').click()">üñºÔ∏è</button>
                        <input type="text" id="msg-input" placeholder="Type..." style="width:50%; padding:10px; border-radius:25px; border:1px solid var(--neon-border); background:#1a1a2e; color:white; outline:none;" onkeypress="if(event.key==='Enter') send()" />
                        <button class="action-btn" onclick="send()">Send</button>
                    </div>
                </div>
                <input type="file" id="pfp-up" hidden accept="image/*" onchange="processFile(this, 'pfp')" />
                <input type="file" id="bg-up" hidden accept="image/*" onchange="processFile(this, 'bg')" />
                <input type="file" id="img-send" hidden accept="image/*" onchange="sendImage(this)" />
            </div>
        </div>
        
        <!-- Updates Window -->
        <div id="updates-window" class="window" style="width: 700px; height: 500px; top: 20%; left: 10%;">
            <div class="window-header">
                <div class="window-title">üì∞ Update Log</div>
                <div class="window-controls">
                    <button class="window-control" onclick="minimizeWindow('updates-window')">‚îÄ</button>
                    <button class="window-control" onclick="maximizeWindow('updates-window')">‚ñ°</button>
                    <button class="window-control" onclick="closeWindow('updates-window')">‚úï</button>
                </div>
            </div>
            <div class="window-content">
                <iframe src="https://docs.google.com/document/d/1iDgURNHAHjC1LSzZ7y6IxyJmem_bS4d22apmq37zQfE/" frameborder="0" marginheight="0" marginwidth="0" style="width:100%; height:100%;">Loading‚Ä¶</iframe>
            </div>
        </div>
        
        <!-- Settings Window -->
        <div id="settings-window" class="window" style="width: 600px; height: 500px; top: 15%; left: 30%;">
            <div class="window-header">
                <div class="window-title">‚öôÔ∏è System Settings</div>
                <div class="window-controls">
                    <button class="window-control" onclick="minimizeWindow('settings-window')">‚îÄ</button>
                    <button class="window-control" onclick="maximizeWindow('settings-window')">‚ñ°</button>
                    <button class="window-control" onclick="closeWindow('settings-window')">‚úï</button>
                </div>
            </div>
            <div class="window-content">
                <div style="padding: 20px; color: white;">
                    <h2 style="text-align:center; color:var(--neon); margin-bottom:30px;">SYSTEM SETTINGS</h2>
                    <div style="max-width:420px; margin:0 auto;">
                        <h3 style="color:var(--neon); margin:20px 0 12px;">UI Color</h3>
                        <div style="display:flex; flex-wrap:wrap; gap:12px; justify-content:center;">
                            <button class="theme-btn" data-color="#00f2ff" style="background:#00f2ff;" onclick="setThemeColor(this)">Cyan</button>
                            <button class="theme-btn" data-color="#ff2e63" style="background:#ff2e63;" onclick="setThemeColor(this)">Red</button>
                            <button class="theme-btn" data-color="#00ff9d" style="background:#00ff9d;" onclick="setThemeColor(this)">Green</button>
                            <button class="theme-btn" data-color="#d000ff" style="background:#d000ff;" onclick="setThemeColor(this)">Purple</button>
                            <button class="theme-btn" data-color="#ffd60a" style="background:#ffd60a; color:#000;" onclick="setThemeColor(this)">Yellow</button>
                            <button class="theme-btn" data-color="#ff6b35" style="background:#ff6b35;" onclick="setThemeColor(this)">Orange</button>
                            <button class="theme-btn" data-color="#ffffff" style="background:#ffffff; color:#000;" onclick="setThemeColor(this)">White</button>
                        </div>
                        <h3 style="color:var(--neon); margin:40px 0 12px;">Tab Cloaking</h3>
                        <button class="action-btn cloak-btn" style="background:linear-gradient(45deg, #ff5555, #aa0000);" onclick="cloakInAboutBlank()">Open in about:blank (cloak tab)</button>
                        <p style="font-size:13px; color:#aaa; text-align:center; line-height:1.4;">
                            Results may vary<br />(if you see this you're not blind)
                        </p>
                        <h3 style="color:var(--neon); margin:40px 0 12px;">System Info</h3>
                        <div style="background: rgba(30,30,45,0.8); padding: 15px; border-radius: 10px; border: 1px solid var(--neon-border);">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>OS Version:</span>
                                <span style="color: var(--neon);">Learning OS V2.0.5</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>Games:</span>
                                <span style="color: var(--neon);" id="games-count">Loading...</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>Apps:</span>
                                <span style="color: var(--neon);" id="apps-count">Loading...</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span>Theme:</span>
                                <span style="color: var(--neon);" id="current-theme">Default</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- TASKBAR -->
    <div id="taskbar">
        <button id="start-button" onclick="toggleStartMenu()">üöÄ</button>
        
        <div id="taskbar-icons">
            <!-- Taskbar icons will be added dynamically -->
        </div>
        
        <div id="system-tray">
            <div id="battery-indicator">üîã <span id="battery-level">100%</span></div>
            <div id="clock">üïê <span id="time-display">00:00</span></div>
        </div>
    </div>
    
    <!-- START MENU -->
    <div id="start-menu">
        <div id="start-header">Learning OS V2.0.5</div>
        <div id="start-menu-items">
            <div class="start-menu-item" onclick="openWindow('games-window'); toggleStartMenu();">
                <div class="start-menu-icon">üéÆ</div>
                <div>Games</div>
            </div>
            <div class="start-menu-item" onclick="openWindow('apps-window'); toggleStartMenu();">
                <div class="start-menu-icon">üì±</div>
                <div>Applications</div>
            </div>
            <div class="start-menu-item" onclick="openWindow('chat-window'); toggleStartMenu();">
                <div class="start-menu-icon">üí¨</div>
                <div>Local Chat</div>
            </div>
            <div class="start-menu-item" onclick="openWindow('updates-window'); toggleStartMenu();">
                <div class="start-menu-icon">üì∞</div>
                <div>Update Log</div>
            </div>
            <div class="start-menu-item" onclick="openWindow('settings-window'); toggleStartMenu();">
                <div class="start-menu-icon">‚öôÔ∏è</div>
                <div>Settings</div>
            </div>
            <div class="start-menu-item" onclick="cloakInAboutBlank(); toggleStartMenu();">
                <div class="start-menu-icon">üï∂Ô∏è</div>
                <div>Cloak Tab</div>
            </div>
            <div class="start-menu-item" onclick="openRandom('games'); toggleStartMenu();">
                <div class="start-menu-icon">üé≤</div>
                <div>Random Game</div>
            </div>
            <div class="start-menu-item" onclick="openRandom('apps'); toggleStartMenu();">
                <div class="start-menu-icon">üåÄ</div>
                <div>Random App</div>
            </div>
        </div>
    </div>
    
    <!-- OVERLAY FOR GAMES/APPS -->
    <div id="overlay-container">
        <button id="close-overlay-btn" onclick="closeOverlay()">‚úï</button>
        <iframe id="overlay-frame" src=""></iframe>
    </div>
    
    <script>
        // ===== OS INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            initializeOS();
            createStarfield();
            launchShootingStar();
            loadGamesAndApps();
            initializeWindowDrag();
            updateSystemInfo();
            setInterval(updateClock, 1000);
            updateClock();
            
            // Load saved theme
            const savedTheme = localStorage.getItem("freedom_theme");
            if (savedTheme) {
                setThemeColorFromStorage(savedTheme);
            }
            
            // Load chat data if exists
            const storedUser = localStorage.getItem("freedom_user");
            if (storedUser) {
                const userData = JSON.parse(storedUser);
                document.getElementById("login-overlay").style.display = "none";
                if (userData.bg) {
                    document.getElementById("chat-bg-layer").style.background = `url('${userData.bg}') center center / cover no-repeat fixed`;
                }
                loadChatHistory();
            }
        });
        
        // ===== OS FUNCTIONS =====
        function initializeOS() {
            console.log("Learning OS V2.0.5 initialized");
        }
        
        // ===== WINDOW MANAGEMENT =====
        let activeWindow = null;
        let windowZIndex = 100;
        
        function openWindow(windowId) {
            // Close start menu if open
            document.getElementById('start-menu').classList.remove('active');
            
            // Close any other active windows
            if (activeWindow && activeWindow !== windowId) {
                document.getElementById(activeWindow).classList.remove('active');
                document.querySelector(`.desktop-icon[data-window="${activeWindow}"]`)?.classList.remove('active');
                document.querySelector(`.taskbar-icon[data-window="${activeWindow}"]`)?.classList.remove('active');
            }
            
            // Open the requested window
            const windowElement = document.getElementById(windowId);
            windowElement.classList.add('active');
            windowElement.style.zIndex = ++windowZIndex;
            activeWindow = windowId;
            
            // Update desktop icon
            document.querySelector(`.desktop-icon[data-window="${windowId}"]`)?.classList.add('active');
            
            // Add to taskbar if not already there
            addToTaskbar(windowId, windowElement.querySelector('.window-title').textContent);
            
            // Bring window to front
            bringWindowToFront(windowId);
        }
        
        function closeWindow(windowId) {
            document.getElementById(windowId).classList.remove('active');
            document.querySelector(`.desktop-icon[data-window="${windowId}"]`)?.classList.remove('active');
            document.querySelector(`.taskbar-icon[data-window="${windowId}"]`)?.classList.remove('active');
            
            if (activeWindow === windowId) {
                activeWindow = null;
            }
        }
        
        function minimizeWindow(windowId) {
            document.getElementById(windowId).classList.remove('active');
            document.querySelector(`.desktop-icon[data-window="${windowId}"]`)?.classList.remove('active');
            document.querySelector(`.taskbar-icon[data-window="${windowId}"]`)?.classList.add('minimized');
        }
        
        function maximizeWindow(windowId) {
            const windowElement = document.getElementById(windowId);
            if (windowElement.style.width === '95vw' && windowElement.style.height === '90vh') {
                // Restore
                windowElement.style.width = '';
                windowElement.style.height = '';
                windowElement.style.top = '';
                windowElement.style.left = '';
            } else {
                // Maximize
                windowElement.style.width = '95vw';
                windowElement.style.height = '90vh';
                windowElement.style.top = '5vh';
                windowElement.style.left = '2.5vw';
            }
        }
        
        function bringWindowToFront(windowId) {
            const windowElement = document.getElementById(windowId);
            windowElement.style.zIndex = ++windowZIndex;
            activeWindow = windowId;
            
            // Update taskbar icons
            document.querySelectorAll('.taskbar-icon').forEach(icon => {
                icon.classList.remove('active');
            });
            document.querySelector(`.taskbar-icon[data-window="${windowId}"]`)?.classList.add('active');
        }
        
        // ===== TASKBAR MANAGEMENT =====
        function addToTaskbar(windowId, title) {
            const taskbarIcons = document.getElementById('taskbar-icons');
            const existingIcon = document.querySelector(`.taskbar-icon[data-window="${windowId}"]`);
            
            if (!existingIcon) {
                const icon = document.createElement('div');
                icon.className = 'taskbar-icon';
                icon.setAttribute('data-window', windowId);
                icon.innerHTML = title.charAt(0);
                icon.title = title;
                icon.onclick = function() {
                    const windowElement = document.getElementById(windowId);
                    if (windowElement.classList.contains('active')) {
                        minimizeWindow(windowId);
                    } else {
                        openWindow(windowId);
                    }
                };
                taskbarIcons.appendChild(icon);
            }
        }
        
        // ===== START MENU =====
        function toggleStartMenu() {
            document.getElementById('start-menu').classList.toggle('active');
        }
        
        // Close start menu when clicking outside
        document.addEventListener('click', function(event) {
            const startMenu = document.getElementById('start-menu');
            const startButton = document.getElementById('start-button');
            
            if (startMenu.classList.contains('active') && 
                !startMenu.contains(event.target) && 
                !startButton.contains(event.target)) {
                startMenu.classList.remove('active');
            }
        });
        
        // ===== WINDOW DRAGGING =====
        function initializeWindowDrag() {
            document.querySelectorAll('.window-header').forEach(header => {
                header.addEventListener('mousedown', function(e) {
                    const windowElement = this.parentElement;
                    bringWindowToFront(windowElement.id);
                    
                    let offsetX = e.clientX - windowElement.offsetLeft;
                    let offsetY = e.clientY - windowElement.offsetTop;
                    
                    function mouseMoveHandler(e) {
                        windowElement.style.left = (e.clientX - offsetX) + 'px';
                        windowElement.style.top = (e.clientY - offsetY) + 'px';
                    }
                    
                    function mouseUpHandler() {
                        document.removeEventListener('mousemove', mouseMoveHandler);
                        document.removeEventListener('mouseup', mouseUpHandler);
                    }
                    
                    document.addEventListener('mousemove', mouseMoveHandler);
                    document.addEventListener('mouseup', mouseUpHandler);
                });
            });
        }
        
        // ===== SYSTEM INFO =====
        function updateSystemInfo() {
            // Update games count
            const gamesCount = document.querySelectorAll('#games-grid .game-item').length;
            document.getElementById('games-count').textContent = `${gamesCount} games`;
            
            // Update apps count
            const appsCount = document.querySelectorAll('#apps-grid .app-item').length;
            document.getElementById('apps-count').textContent = `${appsCount} apps`;
            
            // Update current theme
            const currentColor = getComputedStyle(document.documentElement).getPropertyValue('--neon').trim();
            const themeButtons = document.querySelectorAll('.theme-btn');
            let themeName = 'Default';
            themeButtons.forEach(btn => {
                if (btn.getAttribute('data-color') === currentColor) {
                    themeName = btn.textContent;
                }
            });
            document.getElementById('current-theme').textContent = themeName;
        }
        
        // ===== CLOCK AND BATTERY =====
        function updateClock() {
            const now = new Date();
            const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            document.getElementById('time-display').textContent = timeString;
            
            // Update battery if available
            if (navigator.getBattery) {
                navigator.getBattery().then(battery => {
                    const level = Math.round(battery.level * 100) + '%';
                    document.getElementById('battery-level').textContent = level;
                });
            }
        }
        
        // ===== STARFIELD ANIMATION =====
        function createStarfield() {
            const field = document.getElementById("starField");
            for (let i = 0; i < 35; i++) {
                let x, y, dist;
                do {
                    x = Math.random() * 100;
                    y = Math.random() * 100;
                    dist = Math.sqrt(Math.pow(x - 50, 2) + Math.pow(y - 50, 2));
                } while (dist < 23);
                const star = document.createElement("div");
                star.className = "star";
                const size = Math.random() * 12 + 8;
                star.style.left = x + "%";
                star.style.top = y + "%";
                star.style.width = size + "px";
                star.style.height = size + "px";
                star.style.animationDelay = Math.random() * -10 + "s";
                field.appendChild(star);
            }
        }
        
        function launchShootingStar() {
            const shooter = document.getElementById("shooter");
            shooter.style.top = Math.random() * 40 + "%";
            shooter.style.left = Math.random() * 30 + 70 + "%";
            shooter.classList.add("animate-shooting");
            setTimeout(() => shooter.classList.remove("animate-shooting"), 2500);
            setTimeout(launchShootingStar, Math.random() * 8000 + 5000);
        }
        
        // ===== GAMES AND APPS LOADING =====
        function loadGamesAndApps() {
            // Games data from original code
            const games = [
                { emoji: "üèπ", name: "Ragdoll Archers", url: "https://ze-man.github.io/Ragdoll-Archers/" },
                { emoji: "ü§ï", name: "Ragdoll Hit", url: "https://ze-man.github.io/Ragdoll-Hit/" },
                { emoji: "üß©", name: "Banjo‚ÄëKazooie", url: "https://ze-man.github.io/Banjo-Kazooie/" },
                { emoji: "‚öîÔ∏è", name: "Melee Light", url: "https://ikneedata.com/meleelight.html" },
                { emoji: "üèÄ", name: "Basket Random", url: "https://genizymath.github.io/iframe/66.html" },
                { emoji: "‚ò¢Ô∏è", name: "Half‚ÄëLife", url: "https://genizymath.github.io/iframe/262.html" },
                { emoji: "üè†", name: "House of Hazards", url: "https://ze-man.github.io/HouseOfhazards/" },
                { emoji: "‚öñÔ∏è", name: "Ace Attorney", url: "https://cubeguide.github.io/econclasshelp/games/aceattorney/index.html" },
                { emoji: "üëî", name: "Justice For All", url: "https://ze-man.github.io/Justiceforall/" },
                { emoji: "‚òï", name: "Trials & Tribulations", url: "https://ze-man.github.io/Trials-And-tribulations/" },
                { emoji: "üåé", name: "Solar Smash", url: "https://genizymath.github.io/iframe/118.html" },
                { emoji: "‚òéÔ∏è", name: "Thats not my Neighbor", url: "https://genizymath.github.io/iframe/216.html" },
                { emoji: "üí∞", name: "Breaking the Bank", url: "https://cubeguide.github.io/econclasshelp/games/breakingthebank/index.html" },
                { emoji: "‚õìÔ∏è", name: "Escaping the Prison", url: "https://cubeguide.github.io/econclasshelp/games/escapingtheprison/index.html" },
                { emoji: "üíé", name: "Stealing the Diamond", url: "https://cubeguide.github.io/econclasshelp/games/stealingthediamond/index.html" },
                { emoji: "‚òÅÔ∏è", name: "Infiltrating the Airship", url: "https://cubeguide.github.io/econclasshelp/games/infiltratingtheairship/index.html" },
                { emoji: "üè¢", name: "Fleeing the Complex", url: "https://cubeguide.github.io/econclasshelp/games/fleeingthecomplex/index.html" },
                { emoji: "üè´", name: "Riddle School 1", url: "https://cubeguide.github.io/econclasshelp/games/riddleschool/riddleschool1/index.html" },
                { emoji: "üìô", name: "Riddle School 2", url: "https://cubeguide.github.io/econclasshelp/games/riddleschool/riddleschool2/index.html" },
                { emoji: "üìï", name: "Riddle School 3", url: "https://cubeguide.github.io/econclasshelp/games/riddleschool/riddleschool3/index.html" },
                { emoji: "üìó", name: "Riddle School 4", url: "https://cubeguide.github.io/econclasshelp/games/riddleschool/riddleschool4/index.html" },
                { emoji: "üìì", name: "Riddle School 5", url: "https://cubeguide.github.io/econclasshelp/games/riddleschool/riddleschool5/index.html" },
                { emoji: "üëΩ", name: "Riddle Transfer 1", url: "https://cubeguide.github.io/econclasshelp/games/riddleschool/riddletransfer/index.html" },
                { emoji: "üõ∏", name: "Riddle Transfer 2", url: "https://cubeguide.github.io/econclasshelp/games/riddleschool/riddletransfer2/index.html" },
                { emoji: "üêª", name: "FNAF 1", url: "https://ze-man.github.io/FNaf-1/" },
                { emoji: "üê∞", name: "FNAF 2", url: "https://ze-man.github.io/FNaF-2/" },
                { emoji: "üê•", name: "FNAF 3", url: "https://cubeguide.github.io/econclasshelp/games/fnaf-3/index.html" },
                { emoji: "ü¶ä", name: "FNAF 4", url: "https://cubeguide.github.io/econclasshelp/games/fnaf-4/index.html" },
                { emoji: "ü§°", name: "Sister Location", url: "https://genizymath.github.io/iframe/185.html" },
                { emoji: "üçï", name: "Pizzeria Sim", url: "https://ze-man.github.io/FNaF-PizzaSim/" },
                { emoji: "üëπ", name: "Custom Night", url: "https://ze-man.github.io/FNaF-UCN/" },
                { emoji: "üñçÔ∏è", name: "Kindergarten 1", url: "https://genizymath.github.io/iframe/445.html" },
                { emoji: "üéí", name: "Kindergarten 2", url: "https://genizymath.github.io/iframe/446.html" },
                { emoji: "üçé", name: "Kindergarten 3", url: "https://genizymath.github.io/iframe/501.html" },
                { emoji: "ü•õ", name: "Cuphead", url: "https://genizymath.github.io/iframe/465.html" },
                { emoji: "üó°Ô∏è", name: "Hollow Knight", url: "https://ze-man.github.io/Hollow-Knight/" },
                { emoji: "üåü", name: "Super Mario 64", url: "https://cubeguide.github.io/econclasshelp/games/sm64/index.html" },
                { emoji: "üçÑ", name: "Super Mario World", url: "https://cubeguide.github.io/econclasshelp/games/supermarioworld/index.html" },
                { emoji: "üåÄ", name: "Sonic 1", url: "hhttps://ze-man.github.io/Sanic1/" },
                { emoji: "üåÄ", name: "Sonic 2", url: "https://ze-man.github.io/Sanic-2/" },
                { emoji: "üåÄ", name: "Sonic 3", url: "https://cubeguide.github.io/econclasshelp/games/sonicthehedgehog3/index.html" },
                { emoji: "ü¶ä", name: "Star Fox 64", url: "https://cubeguide.github.io/econclasshelp/games/starfox64/index.html" },
                { emoji: "üí•", name: "Super Smash Bros", url: "https://cubeguide.github.io/econclasshelp/games/supersmashbros/index.html" },
                { emoji: "‚õèÔ∏è", name: "Minecraft", url: "https://ze-man.github.io/Eaglercraft-launcher/" },
                { emoji: "üß±", name: "Tetris", url: "https://cubeguide.github.io/econclasshelp/games/tetris/index.html" },
                { emoji: "üèÉ", name: "OvO", url: "https://cubeguide.github.io/econclasshelp/games/ovo/index.html" },
                { emoji: "üìâ", name: "Slope", url: "https://cubeguide.github.io/econclasshelp/games/slope/index.html" },
                { emoji: "üç™", name: "Cookie Clicker", url: "https://cubeguide.github.io/econclasshelp/games/cookieclicker/index.html" },
                { emoji: "üõπ", name: "Subway Surfers", url: "https://nb-ga.github.io/games-site/projects/subway-surfers-san-francisco/index.html" },
                { emoji: "üß¨", name: "BitLife", url: "https://nb-ga.github.io/games-site/projects/bitlife/index.html" },
                { emoji: "üéí", name: "Jetpack Joyride", url: "https://cubeguide.github.io/econclasshelp/games/jetpackjoyride/index.html" },
                { emoji: "ü™ù", name: "Stickman Hook", url: "https://cubeguide.github.io/econclasshelp/games/stickmanhook/index.html" },
                { emoji: "ü¶ñ", name: "Chrome Dino", url: "https://cubeguide.github.io/econclasshelp/games/dinogame/index.html" },
                { emoji: "üî´", name: "Getaway Shootout", url: "https://ze-man.github.io/Getaway-SHootout/" },
                { emoji: "üé≤", name: "Buckshot Roulette", url: "https://ze-man.github.io/Buckshot-Roulette/" },
                { emoji: "üéØ", name: "1v1.LOL", url: "https://login.oaklandscioly.org/zones/html/1v1lol/" },
                { emoji: "üî´", name: "Gun Spin", url: "https://ze-man.github.io/GunSpin/" },
                { emoji: "üèéÔ∏è", name: "Drift Hunters", url: "https://cubeguide.github.io/econclasshelp/games/drifthunters/index.html" },
                { emoji: "üî•", name: "Drift Hunters Pro", url: "https://unblockedgamess3.gitlab.io/drift-hunters-pro/" },
                { emoji: "üü¶", name: "Geometry Dash Lite", url: "https://ijnfem.github.io/seraph/games/gdlite/index.html" },
                { emoji: "üë¶", name: "School Boy Runaway", url: "https://ze-man.github.io/SchoolBoyRunaway/" },
                { emoji: "ü™ü", name: "The man from the window", url: "https://ze-man.github.io/The-man-from-the-window/" },
                { emoji: "üçï", name: "Pizza Tower", url: "https://ze-man.github.io/PizzaTower/" },
                { emoji: "üêë", name: "Amanda The Adventurer", url: "https://ze-man.github.io/Amandatheadventurer/" },
                { emoji: "üë®", name: "People Playground", url: "https://ze-man.github.io/People-Playground/" },
                { emoji: "üê±", name: "FNaC", url: "https://ze-man.github.io/FNaC/" },
                { emoji: "üöó", name: "Hill Climb Racing", url: "https://ze-man.github.io/hcr/" },
                { emoji: "üòà", name: "Arthur's Nighmare", url: "https://ze-man.github.io/ArthursNightmare/" },
                { emoji: "üçî", name: "Burgers and Frights", url: "https://ze-man.github.io/Burgersandfrights/" },
                { emoji: "üè†", name: "Fears to Fathom", url: "https://ze-man.github.io/FearstoFathom/" },
                { emoji: "‚úíÔ∏è", name: "Bendy and ink Machine", url: "https://genizymath.github.io/iframe/215.html" },
                { emoji: "üë¥", name: "Five Nights at Epstein's", url: "https://ze-man.github.io/FiveNightsatEpsteins/" },
                { emoji: "üèéÔ∏è", name: "Blumgi Rocket", url: "https://ze-man.github.io/Blumgi-Rocket/" }
            ];
            
            // Apps data from original code
            const apps = [
                { img: "https://upload.wikimedia.org/wikipedia/commons/thumb/0/09/YouTube_full-color_icon_%282017%29.svg/1280px-YouTube_full-color_icon_%282017%29.svg.png", name: "Youtube Downloader", url: "https://ssvid.net/en-7" },
                { img: "https://raw.githubusercontent.com/EmulatorJS/EmulatorJS/HEAD/docs/Logo.png", name: "Retro Emulator", url: "https://demo.emulatorjs.org/" },
                { img: "https://cdn-icons-png.flaticon.com/512/2065/2065157.png", name: "URL Opener", url: "https://url-opener.com/" }
            ];
            
            // Load games
            const gamesGrid = document.getElementById('games-grid');
            games.forEach(game => {
                const gameItem = document.createElement('div');
                gameItem.className = 'game-item';
                gameItem.setAttribute('data-url', game.url);
                gameItem.innerHTML = `
                    <div class="icon-emoji">${game.emoji}</div>
                    <span class="item-name">${game.name}</span>
                `;
                gameItem.onclick = () => openGameOrApp(game.url);
                gamesGrid.appendChild(gameItem);
            });
            
            // Load apps
            const appsGrid = document.getElementById('apps-grid');
            apps.forEach(app => {
                const appItem = document.createElement('div');
                appItem.className = 'app-item';
                appItem.setAttribute('data-url', app.url);
                appItem.innerHTML = `
                    <img src="${app.img}" class="icon-img" />
                    <span class="item-name">${app.name}</span>
                `;
                appItem.onclick = () => openGameOrApp(app.url);
                appsGrid.appendChild(appItem);
            });
            
            // Update system info counts
            updateSystemInfo();
        }
        
        // ===== OVERLAY FOR GAMES/APPS =====
        function openGameOrApp(url) {
            const frame = document.getElementById('overlay-frame');
            frame.src = url;
            document.getElementById('overlay-container').style.display = 'block';
            
            // Minimize all windows
            document.querySelectorAll('.window.active').forEach(window => {
                window.classList.remove('active');
            });
        }
        
        function closeOverlay() {
            document.getElementById('overlay-frame').src = '';
            document.getElementById('overlay-container').style.display = 'none';
        }
        
        // ===== SEARCH AND RANDOM =====
        function filterGrid(type) {
            const term = document.getElementById(type === 'games' ? 'game-search' : 'app-search').value.toLowerCase();
            document.querySelectorAll(`#${type}-grid > div`).forEach(item => {
                const name = item.querySelector('.item-name').innerText.toLowerCase();
                item.style.display = name.includes(term) ? 'block' : 'none';
            });
        }
        
        function openRandom(type) {
            const visible = Array.from(document.querySelectorAll(`#${type}-grid > div`))
                              .filter(i => i.style.display !== 'none');
            if (visible.length) {
                const randomItem = visible[Math.floor(Math.random() * visible.length)];
                const url = randomItem.getAttribute('data-url');
                openGameOrApp(url);
            }
        }
        
        // ===== THEME SYSTEM =====
        function setThemeColor(btn) {
            const color = btn.getAttribute('data-color');
            document.documentElement.style.setProperty('--neon', color);
            document.documentElement.style.setProperty('--neon-border', color);
            
            let glow = color + '4d';
            if (color === '#ffd60a' || color === '#ffffff') glow = color + '80';
            document.documentElement.style.setProperty('--neon-glow', glow);
            
            document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            localStorage.setItem('freedom_theme', color);
            updateSystemInfo();
        }
        
        function setThemeColorFromStorage(color) {
            document.documentElement.style.setProperty('--neon', color);
            document.documentElement.style.setProperty('--neon-border', color);
            
            let glow = color + '4d';
            if (color === '#ffd60a' || color === '#ffffff') glow = color + '80';
            document.documentElement.style.setProperty('--neon-glow', glow);
            
            document.querySelector(`.theme-btn[data-color="${color}"]`)?.classList.add('active');
        }
        
        // ===== CLOAKING =====
        function cloakInAboutBlank() {
            if (!confirm("This will try to open the current page in a new about:blank tab.\n\nContinue?")) return;
            
            const fullHTML = document.documentElement.outerHTML;
            const blob = new Blob([fullHTML], {type: "text/html"});
            const url = URL.createObjectURL(blob);
            
            const newWin = window.open("about:blank", "_blank");
            if (newWin) {
                newWin.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Google Docs</title>
                        <link rel="icon" href="https://ssl.gstatic.com/docs/documents/images/kix-favicon7.ico">
                    </head>
                    <body style="margin:0; padding:0; overflow:hidden;">
                        <iframe src="${url}" style="width:100vw; height:100vh; border:none;"></iframe>
                    </body>
                    </html>
                `);
                newWin.document.close();
                
                setTimeout(() => { try { window.close(); } catch(e) {} }, 1200);
            } else {
                alert("Popup was blocked.\nPlease allow popups for this site to use the cloaking feature.");
            }
        }
        
        // ===== CHAT / AUTH LOGIC =====
        let userData = { username: "", pfp: "https://www.gravatar.com/avatar/?d=mp", bg: "" };
        let receivedMsgIds = [];
        let authMode = "login";
        
        function setAuthMode(mode) {
            authMode = mode;
            document.getElementById("tab-login").classList.toggle("active", mode === "login");
            document.getElementById("tab-signup").classList.toggle("active", mode === "signup");
            document.getElementById("name-error").innerText = "";
        }
        
        function handleAuthSubmit() {
            const u = document.getElementById("user-input").value.trim();
            if (!u) {
                document.getElementById("name-error").innerText = "USERNAME REQUIRED";
                return;
            }
            userData.username = u;
            localStorage.setItem("freedom_user", JSON.stringify(userData));
            document.getElementById("login-overlay").style.display = "none";
            loadChatHistory();
        }
        
        function loadChatHistory() {
            const stored = localStorage.getItem("freedom_chat");
            if (stored) {
                JSON.parse(stored).forEach(msg => {
                    if (!receivedMsgIds.includes(msg.id)) {
                        receivedMsgIds.push(msg.id);
                        renderMessage(msg);
                    }
                });
            }
        }
        
        function send() {
            const input = document.getElementById("msg-input");
            const txt = input.value.trim();
            if (!txt) return;
            const id = Date.now();
            const msg = { user: userData.username, text: txt, pic: userData.pfp, id };
            saveMessageLocally(msg);
            receivedMsgIds.push(id);
            renderMessage(msg);
            input.value = "";
        }
        
        function sendImage(input) {
            if (!input.files?.[0]) return;
            const reader = new FileReader();
            reader.onload = e => {
                const id = Date.now();
                const msg = { user: userData.username, pic: userData.pfp, img: e.target.result, id };
                saveMessageLocally(msg);
                receivedMsgIds.push(id);
                renderMessage(msg);
            };
            reader.readAsDataURL(input.files[0]);
        }
        
        function saveMessageLocally(msg) {
            let history = JSON.parse(localStorage.getItem("freedom_chat") || "[]");
            history.push(msg);
            if (history.length > 50) history.shift();
            localStorage.setItem("freedom_chat", JSON.stringify(history));
        }
        
        function renderMessage(data) {
            const area = document.getElementById("chat-area");
            const content = data.text ? `<div>${data.text}</div>` : `<img src="${data.img}" class="chat-img" />`;
            area.insertAdjacentHTML("beforeend", `
                <div class="message-item">
                    <div style="text-align:center; min-width:65px;">
                        <img src="${data.pic || "https://www.gravatar.com/avatar/?d=mp"}" class="pfp-icon" />
                        <div style="font-size:9px; color:#7000ff; font-weight:800; text-transform:uppercase; margin-top:4px;">
                            ${data.user}
                        </div>
                    </div>
                    <div class="bubble">${content}</div>
                </div>
            `);
            area.scrollTop = area.scrollHeight;
        }
        
        function processFile(input, type) {
            if (!input.files?.[0]) return;
            const reader = new FileReader();
            reader.onload = e => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement("canvas");
                    const max = type === "pfp" ? 150 : 1920;
                    let w = img.width, h = img.height;
                    const scale = Math.min(max / w, max / h, 1);
                    canvas.width = w * scale; canvas.height = h * scale;
                    canvas.getContext("2d").drawImage(img, 0, 0, canvas.width, canvas.height);
                    const dataUrl = canvas.toDataURL("image/jpeg", 0.6);
                    if (type === "pfp") userData.pfp = dataUrl;
                    else {
                        userData.bg = dataUrl;
                        document.getElementById("chat-bg-layer").style.background = `url('${dataUrl}') center center / cover no-repeat fixed`;
                    }
                    localStorage.setItem("freedom_user", JSON.stringify(userData));
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(input.files[0]);
        }
        
        function toggleSettings() {
            const s = document.getElementById("settings-overlay");
            s.style.display = (s.style.display === "none" || s.style.display === "") ? "flex" : "none";
        }
        
        function wipeCloudData() {
            if (confirm("Wipe profile & chat data?")) {
                localStorage.removeItem("freedom_user");
                localStorage.removeItem("freedom_chat");
                localStorage.removeItem("freedom_theme");
                location.reload();
            }
        }
        
        function changeName() {
            const n = prompt("New username:", userData.username);
            if (n && n.trim()) {
                userData.username = n.trim();
                localStorage.setItem("freedom_user", JSON.stringify(userData));
            }
        }
    </script>
</body>
</html>
